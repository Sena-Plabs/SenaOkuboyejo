// Years
[...document.querySelectorAll('[id^="year-"], #year, #year-home')].forEach(el=>el.textContent=new Date().getFullYear());
// Wordmark
(function(){const b=document.querySelector('.brand');if(!b)return;const s=`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 256 256" aria-hidden="true" style="display:inline-block;vertical-align:middle"><defs><linearGradient id="g" x1="0" x2="1"><stop offset="0%" stop-color="#7c3aed"/><stop offset="100%" stop-color="#22d3ee"/></linearGradient></defs><circle cx="128" cy="128" r="96" fill="none" stroke="url(#g)" stroke-width="20"/><path d="M70 114c0-26 23-44 53-44 20 0 37 8 48 21" fill="none" stroke="#e6eaf2" stroke-width="18" stroke-linecap="round"/><path d="M70 142c11 13 28 21 48 21 30 0 53-18 53-44" fill="none" stroke="#e6eaf2" stroke-width="18" stroke-linecap="round"/></svg>`;const d=b.querySelector('.dot');if(d)d.remove();b.insertAdjacentHTML('afterbegin',s);})();
// Theme toggle
(function(){const r=document.documentElement;const s=localStorage.getItem('theme');const pl=window.matchMedia&&window.matchMedia('(prefers-color-scheme: light)').matches;const set=t=>{r.setAttribute('data-theme',t);localStorage.setItem('theme',t);};set(s|| (pl?'light':'dark'));const nav=document.querySelector('.nav');if(nav){const btn=document.createElement('button');btn.id='theme-toggle';btn.type='button';btn.setAttribute('aria-label','Toggle color theme');btn.style.cssText='margin-left:auto;border:1px solid rgba(148,163,184,.25);padding:.45rem .6rem;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(0,0,0,.12));color:inherit;cursor:pointer';const ic=()=> (r.getAttribute('data-theme')==='light'?'ðŸŒ™':'â˜€ï¸');btn.textContent=ic();btn.addEventListener('click',()=>{const n=r.getAttribute('data-theme')==='light'?'dark':'light';set(n);btn.textContent=ic();});nav.appendChild(btn);}})();
// Email reveal
(function(){document.querySelectorAll('[data-user][data-domain]').forEach(el=>{const addr=`${el.getAttribute('data-user')}@${el.getAttribute('data-domain').replace('(dot)','.')}`;el.textContent=addr;el.href='mailto:'+addr;});})();
// Projects feed
(function(){const grids=document.querySelectorAll('#projects-grid, .projects-grid');grids.forEach(g=>{const src=g.getAttribute('data-src') || '/senaokuboyejo/assets/data/projects.json';fetch(src).then(r=>r.json()).then(items=>{g.innerHTML=items.map(i=>`<article class="card pad"><h3>${i.title}</h3><p>${i.summary}</p>${i.tags?`<p class="subtext">${i.tags.join(' â€¢ ')}</p>`:''}${i.url?`<a class="btn" href="${i.url}">Open</a>`:''}</article>`).join('');}).catch(()=>{g.innerHTML='<p class="subtext">Could not load projects right now.</p>';});});})();
// Sitemap generator
(function(){function build(){const origin='https://sena-plabs.github.io';const base='/senaokuboyejo';const hrefs=Array.from(document.querySelectorAll('a[href^="/"]')).map(a=> new URL(a.getAttribute('href'), origin).href).filter(u=>!u.includes('#'));const unique=Array.from(new Set([`${origin}${base}/`,`https://sena-plabs.github.io/senaokuboyejo/about.html`,`https://sena-plabs.github.io/senaokuboyejo/experience.html`,`https://sena-plabs.github.io/senaokuboyejo/case-studies/`,`https://sena-plabs.github.io/senaokuboyejo/teaching-speaking/`,`https://sena-plabs.github.io/senaokuboyejo/publications/`,`https://sena-plabs.github.io/senaokuboyejo/contact.html`,...hrefs]));const xml=`<?xml version="1.0" encoding="UTF-8"?>\n<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">\n`+unique.map(u=>`  <url><loc>${u}</loc></url>`).join('\n')+`\n</urlset>`;const blob=new Blob([xml],{type:'application/xml'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='sitemap.xml';a.click();URL.revokeObjectURL(a.href);}
const foot=document.querySelector('footer .container, .site-foot');if(foot){const link=document.createElement('a');link.href='#';link.textContent='Generate sitemap.xml';link.style.marginLeft='1rem';link.addEventListener('click',e=>{e.preventDefault();build();});const p=foot.querySelector('p');(p||foot).appendChild(link);}})();
